{
 "accept_payment": 0,
 "allow_comments": 1,
 "allow_delete": 1,
 "allow_edit": 1,
 "allow_incomplete": 0,
 "allow_multiple": 1,
 "allow_print": 0,
 "amount": 0.0,
 "amount_based_on_field": 0,
 "breadcrumbs": "[{\"label\":_(\"Issues\"), \"route\":\"issues\"}]",
 "client_script": "frappe.web_form.on('location', (field, value) => { \nconsole.log('trigger location')\n    if (frappe.web_form.get_field('location').value){ \n        filterAsset(frappe.web_form.get_field('location').value,`api/resource/Asset?filters=[[\"Asset\",\"location\",\"=\",\"${frappe.web_form.get_field('location').value}\"]]`); \n        filterSrNo(frappe.web_form.get_field('location').value,`api/resource/Asset%20Serial%20No?filters=[[\"Asset%20Serial%20No\",\"location\",\"=\",\"${frappe.web_form.get_field('location').value}\"]]`); \n        } \n    else{ \n        filterAsset(frappe.web_form.get_field('location').value,`api/resource/Asset`); \n        filterSrNo(frappe.web_form.get_field('location').value,`api/resource/Asset%20Serial%20No`); \n        } }) \n\nfunction filterAsset(location,url) { \n        $.ajax({ url:url, success: function(result) \n        { \n            var options = [] \n            for (var i = 0; i < result.data.length; i++) \n            { \n                options.push({ 'label': result.data[i].name, 'value': result.data[i].name }) \n            } \n            var field = frappe.web_form.get_field('asset'); \n            field._data = options; field.refresh();\n        } }); \n    } \n    \nfunction filterSrNo(location,url) \n    { \n        $.ajax({ url:url, success: function(result) \n        { \n            var options = [] \n            for (var i = 0; i < result.data.length; i++) \n            { \n                options.push({ 'label': result.data[i].name, 'value': result.data[i].name }) \n            } \n            var field = frappe.web_form.get_field('serial_no'); \n            field._data = options; field.refresh(); \n        } }); \n    } \nfrappe.web_form.on('asset', (field, value) => { \n    console.log('trigger Asset')\n    getsrno(frappe.web_form.get_field('asset').value) \n    }) \n    \nfunction getsrno(asset) { \n    $.ajax({ url:`api/resource/Asset%20Serial%20No?filters=[[\"Asset%20Serial%20No\",\"asset\",\"=\",\"${asset}\"]]`, success: function(result) { \n        if (result.data){ \n            frappe.web_form.set_value(['serial_no'], result.data[0].name) \n        } } }); \n    }\n\nfrappe.web_form.on('serial_no', (field, value) => { \n    if (frappe.web_form.get_field('serial_no').value){\n    get_asset_location(frappe.web_form.get_field('serial_no').value)\n    }\n    else{\n    filterAsset(frappe.web_form.get_field('serial_no').value,`api/resource/Asset`); \n     filterLocation(frappe.web_form.get_field('serial_no').value,`api/resource/Location`);\n    }\n    }) \n    \nfunction get_asset_location(serial_no) { \n   $.ajax({ url:`api/resource/Asset%20Serial%20No/${serial_no}`, success: function(result) { \n        if (result.data){ \n            var asset_options = [] \n            asset_options.push({ 'label': result.data.asset, 'value': result.data.asset }) \n            var asset_field = frappe.web_form.get_field('asset'); \n            asset_field._data = asset_options; asset_field.refresh();\n            \n            var location_options = [] \n            location_options.push({ 'label': result.data.location, 'value': result.data.location }) \n            var location_field = frappe.web_form.get_field('location'); \n            console.log(location_options)\n            location_field._data = location_options; location_field.refresh();\n          \n        } } }); \n    }\n    \nfunction filterLocation(location,url) { \n        $.ajax({ url:url, success: function(result) \n        { \n            var options = [] \n            for (var i = 0; i < result.data.length; i++) \n            { \n                options.push({ 'label': result.data[i].name, 'value': result.data[i].name }) \n            } \n            var field = frappe.web_form.get_field('location'); \n            field._data = options; field.refresh();\n        } }); \n    } ",
 "creation": "2016-06-24 15:50:33.186483",
 "doc_type": "Issue",
 "docstatus": 0,
 "doctype": "Web Form",
 "idx": 0,
 "introduction_text": "",
 "is_standard": 1,
 "login_required": 1,
 "max_attachment_size": 0,
 "modified": "2021-01-06 12:48:53.599835",
 "modified_by": "Administrator",
 "module": "mfi",
 "name": "issues",
 "owner": "Administrator",
 "published": 1,
 "route": "issues",
 "route_to_success_link": 0,
 "show_attachments": 0,
 "show_in_grid": 0,
 "show_sidebar": 0,
 "sidebar_items": [],
 "success_message": "",
 "success_url": "/issues",
 "title": "Issue",
 "web_form_fields": [
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "subject_section",
   "fieldtype": "Section Break",
   "hidden": 0,
   "label": "Subject",
   "max_length": 0,
   "max_value": 0,
   "options": "fa fa-flag",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "subject",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Subject",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 1,
   "fieldname": "location",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Location",
   "max_length": 0,
   "max_value": 0,
   "options": "Location",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 1,
   "fieldname": "asset",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Asset",
   "max_length": 0,
   "max_value": 0,
   "options": "Asset",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "serial_no",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Serial No",
   "max_length": 0,
   "max_value": 0,
   "options": "Asset Serial No",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "asset_name",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Asset Name",
   "max_length": 0,
   "max_value": 0,
   "read_only": 1,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 1,
   "fieldname": "error_code",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Error Code",
   "max_length": 0,
   "max_value": 0,
   "options": "Error Codes",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "cb00",
   "fieldtype": "Column Break",
   "hidden": 0,
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "default": "Open",
   "fieldname": "status",
   "fieldtype": "Select",
   "hidden": 0,
   "label": "Status",
   "max_length": 0,
   "max_value": 0,
   "options": "Open\nReplied\nHold\nClosed\nAssigned",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "default": "Medium",
   "fieldname": "priority",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Priority",
   "max_length": 0,
   "max_value": 0,
   "options": "Issue Priority",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 1,
   "fieldname": "issue_type",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Issue Type",
   "max_length": 0,
   "max_value": 0,
   "options": "Issue Type",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "failure_date_and_time",
   "fieldtype": "Datetime",
   "hidden": 0,
   "label": "Failure Date and Time",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "sb_details",
   "fieldtype": "Section Break",
   "hidden": 0,
   "label": "Details",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "description",
   "fieldtype": "Text Editor",
   "hidden": 0,
   "label": "Description",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "attachment",
   "fieldtype": "Attach",
   "hidden": 0,
   "label": "Attachment",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  }
 ]
}